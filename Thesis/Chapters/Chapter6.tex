% -*- TeX-master: "../Thesis.tex" -*-


\chapter{Visualization}\label{cha:web}

\epigraphhead[75]{
  \epigraph{\itshape By visualizing information, we turn it into a landscape
    that you can explore with your eyes.}
  {---\scshape David McCandless}
}


\lettrine{U}{na} de las partes fundamentales de este proyecto ha sido la de
presentar una herramienta de visualización de los resultados interactivas y
enfocada a un usuario sin conocimientos en el ámbito de la \gls{ai}. Para ello,
se ha escogido la creación de una aplicación web, principalmente por su
versatilidad y su facilidad de uso: no presenta la necesidad de instalación de
ningún programa específico, tan solo el uso de un navegador web.

En esta web se podrá encontrar toda la información relacionada con este
proyecto, así como se darán herramientas para poder interactuar con los modelos
creados que resuelven la tarea de \gls{rec}. Toda la funcionalidad presente
para el usuario y su creación se discutirá en la \vref{sec:frontend}. Ahora
bien, como es bien condo en el ambito del diseño de aplicaciones web, toda
\gls{ui} necesita de código en el back end que la haga posible (ver
\vref{sec:backend} para una explicación detallada).


\section{\glsentrylong{ui}}%
\label{sec:frontend}\index{Front end}\index{User!interface}

La \gls{ui} se ha creado con la idea de ser lo más sencilla posible. De esta
manera, cualquier tipo de usuario no especializado podrá realizar una
evaluación cualitativa del modelo usado. See \vref{fig:web} for a screenshot of
the web interface.

\begin{figure}[ht]
  \centering
  \includegraphics[width=.75\textwidth]{Images/Web.png}
  \caption[Screenshot de la web creada]{Screenshot de la web creada. En ella se
    puede observar la navbar y la primera parte de la web. Figure created by
    the author.}\label{fig:web}
\end{figure}

Además de proponer un medio interactivo donde se puede realizar \gls{rec} con
imágenes y \gls{re} arbitrarias, en la web también se podrá encontrar
explicaciones acerca de este trabajo, descargar esta memoria y encontrar todo
el código fuente desarrollado. Esta web será una versión online pública y
transparente conteniendo todo el trabajo de esta tesis.

Diferentes maneras de interactuar con esta interfaz son posibles. Entre ellas,
por ejemplo, se han añadido tres opciones para introducir imágenes para la
realización de \gls{rec}. Estas son las siguientes,
\begin{itemize}
  \item \textbf{Gallery}. Diferentes imágenes son mostradas en una galería
  insertada en la web. Estas son tomadas del \gls{coco} dataset.\footnote{Cabe
    destacar aquí que, al ser tomadas del \gls{coco} dataset, la mayoría de las
    imaǵenes que aparecen en esta galería \emph{no} han sido utilizadas para
    entrenar el modelo neuronal.}
  \item \textbf{Web address}. Una imagen también puede ser añadida a la web
  desde una fuente externa usando la web address de la misma (la URL).
  \item \textbf{Locally}. Por último, es posible subir una imagen desde el
  almacenamiento local del ordenador propio a la web.
\end{itemize}

En el caso de añadir la \gls{re} hay dos opciones de manera que se facilite la
interacción con el modelo. Estas son las siguientes,
\begin{itemize}
  \item \textbf{Keyboard}. La \gls{re} puede ser introducida usando el teclado
  de manera habitual.
  \item \textbf{Voice}. También es posible introducir la \gls{re} de manera más
  cómoda usando la voz. Para ello solo es necesario con presionar el butón
  correspondiente en la página principal de manera que se abra la ventana
  correspondiente a la introducción por voz de comandos (see
  \vref{fig:voice}). Aquí deberemos dar permisos a la web para acceder al
  micrófono y ya podremos grabar la \gls{re} que queramos.
  \begin{figure}[ht]
    \centering
    \includegraphics[width=.75\textwidth]{Images/Voice.png}
    \caption[Web interface for voice input]{Web interface for voice input. Aquí
      se puede hablar directamente al micrófono del ordenador como método
      alternativo para introducir una \gls{re}. Este audio será convertido
      usando un modelo neuronal a texto. Figure created by the
      author.}\label{fig:voice}
  \end{figure}
\end{itemize}

\subsection{Responsive Design and Accessibility}%
\index{Responsive design}\index{Accesibility}

Responsive web design and accessibility son dos conceptos diferentes, pero que
aún así están relacionados entre sí de muchas maneras. Estos dos conceptos
encajan dentro de la idea de \gls{ux}\index{User!experience} que es la manera
en la que un usuario interactua con un determinado producto o servicio. Aquí se
incluye la percepción del usuario de eficiencia, facilidad de uso y utilidad.

\gls{rd} se ocupa de proveer al usuario de la mejor experiencia posible de
visualización sin importar el dispositivo que se está usando. Esto es, la
interfaz de una web, es capaz de adaptarse a las dimensiones de la pantalla que
se está usando: la web se mostrará de manera diferente según se esté usando en
un monitor de ordenador, tableta o móvil. La accesibilidad se ocupa de
garantizar que el contenido es fácilmente usable, navigable por personas con
ciertas discapacidades (e.g., problemas de visión).

Podemos ver cómo la web creada se adapta a diferentes anchos comparando la
\vref{fig:web} con la \vref{fig:responsive}. Entre otros aspectos, la galería
adapta el número de columnas según el dispositivo y la navigation bar se
expande o se colapsa dependiendo también del ancho de la pantalla.

\begin{figure}[ht]
  \centering
  \begin{subfigure}[t]{.5\textwidth}
    \centering
    \caption{Collapsed navigation bar.}
    \includegraphics[width=.6\textwidth]{Images/Responsive.png}
  \end{subfigure}\hfill
  \begin{subfigure}[t]{.5\textwidth}
    \centering
    \caption{Expanded navigation bar.}
    \includegraphics[width=.6\textwidth]{Images/Responsive2.png}
  \end{subfigure}
  \caption[Responsive web design.]{Responsive web design. La web está mostrada
    con un ancho típico de dispositivo móvil. La web está diseñada para
    mostrarse correctamente sin importar el ancho del dispositivo
    utilizado. Figure created by the author (both).}\label{fig:responsive}
\end{figure}

Además de estos dos elementos comentados (navigation bar y gallery) otros
diferentes elementos también se ajustan a los diferentes anchos de
pantalla. Entre ellos el footer, el ancho de la imagen segmentada resultado, el
tamaño de la \gls{re} y muchos más.

Otro aspecto fundamental a la hora de realizar un diseño web es el de la
\emph{accessibility}\index{Accesibility}. En palabras de
\myCite{berners-lee21:introd_web_acces}, \gls{w3c}\footnote{Is the main
  international standards organization for the World Wide Web} Director and
inventor of the World Wide Web,

\begin{quoteBox}
  The power of the Web is in its universality. Access by everyone regardless of
  disability is an essential aspect.
  \tcblower\quotecite{berners-lee21:introd_web_acces}
\end{quoteBox}

Para garantizar la accesibilidad de esta web se ha usado principalmente
\gls{aria}, que es una especificación de \gls{w3c} que especifica cómo aumentar
la accesibilidad de páginas web. Esto ha venido facilitado por el uso de una
biblioteca de estilos \gls{css} llamada
\fhref{https://getbootstrap.com/}{Bootstrap}.

\subsection{Guided Usage Example}

Para realizar la tarea de \gls{rec} en una imagen tan solo es necesario
realizar estos tres pasos,
\begin{enumerate}
  \item \textbf{Choose image}. Como ya hemos discutido al comienzo de la
  \vref{sec:frontend}, hay disponibles tres maneras: seleccionar de la galería,
  añadir la web address o escogerla desde el almacenamiento local del
  ordenador.
  \item \textbf{Enter \gls*{re}}. Así mismo, para la introducción de la
  \gls{re} existen dos métodos: mediante el uso del teclado y mediante el uso
  de voz.
  \item \textbf{View results}. Por último, tras clicar en el butón
  \texttt{Submit}, podemos ver el resultado de la ejecución del programa.
\end{enumerate}

Estos métodos han sido probados y funcionan correctamente todos ellos, aunque
con diferentes tiempos de ejecución dependiendo del método usado. Este tiempo
de ejecución dependerá principalmente de tres factores, uso del servidor,
calidad de la imagen seleccionada y el método de introducción de la \gls{re}
(por voz tardará más).

\begin{exampleBox}
  Para tener una aproximación, usando imágenes de la galería mostrada en la
  web, con un solo usuario navegando (servidor no saturado, que es lo habitual)
  e introduciendo la \gls{re} usando el teclado la ejecución completa del
  progama es de unos 6 segundos.
\end{exampleBox}


\section{Back End}\label{sec:backend}\index{Back end}

La funcionalidad principal que ofrece esta web es la de poder interactuar con
este trabajo, i.e., poder ejecutar el modelo presente para realizar la
\gls{rec}. Esto conlleva la ejecucación de código, el cual se podría elegir
ejecutarlo en dos sitios diferentes: en el ordenador del usuario (se debería
usar JavaScript) o en el servidor web (el back end).

Debido al alto uso de recursos computacionales en la ejecución del modelo se ha
decidido realizarlo completamente en el back end.\footnote{También facilita
  esto la posibilidad de ejecutar el código en Python, ya que si no sería
  necesario portar todo el código a JavaScript o usar bibliotecas con las que
  poder emular Python dentro del navegador del cliente.} Para ello, se ha
creado una \gls{api} (creada en PHP) para facilitar la comunicación entre front
end y back end sin necesidad de recargar la página. Tenemos dos rutas
principales que usaremos para comunicar la interfaz web con el backend. Estas
son las siguientes,
\begin{itemize}
  \item \textbf{\gls*{rec}}. Internamente llamada \code{api/comprehend.php},
  que permite realizar la tarea de \gls{rec} llamando internamente en el
  servidor a los archivos de Python adecuados (ejecutando sobre el input del
  usuario el modelo de segmentación, see \vref{sec:rec-model}). Tiene en cuenta
  las diferentes maneras en las que la imagen y la \gls{re} han podido ser
  añadidas.
  \item \textbf{\gls*{stt}}. Internamente llamdada \code{api/stt.php}, que
  permite realizar la tarea de conversión entre speech y texto. Ejecuta el
  modelo Silero (see \vref{sec:speech}) para convertir el audio grabado con el
  micrófono por el usuario a texto.
\end{itemize}


Aquí veremos la estructura del backend. Un gráfico explicativo se encuentra en
la \vref{fig:server}.

\begin{figure}[p]
  \centering
  \resizebox{\textwidth}{!}{\input{Figures/Tikz/Server.tex}}
  \caption[Arquitectura del programa]{Arquitectura del progama. Se puede
    observar la transmisión de datos desde el cliente (el usuario con su web
    browser), hasta la generación de resultados por medio de la \gls{api} en el
    servidor. Figure created by the author.}\label{fig:server}
\end{figure}
