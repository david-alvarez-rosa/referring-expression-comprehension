% -*- TeX-master: "../Thesis.tex" -*-


\chapter{Visualization}\label{cha:web}

\epigraphhead[75]{
  \epigraph{\itshape By visualizing information, we turn it into a landscape
    that you can explore with your eyes.}
  {---\scshape David McCandless}
}


\drop One of the fundamental parts of this project has been to present an
interactive results visualization tool focused on a user without knowledge in
the field of \gls{ai}. To do this, the creation of a web application has been
chosen, mainly because of its versatility and ease of use: it does not require
the installation of any specific program, only the use of a web browser.

On this website you can find all the information related to this project, as
well as tools to interact with the created models that solve the task of
\gls{rec}. All the functionality present for the user and its creation will be
discussed in \vref{sec:frontend}. Now, as is well condo in the field of web
application design, all \gls{ui} needs code in the back end that makes it
possible (see \vref{sec:backend} for a detailed explanation).



\section{\glsentrylong{ui}}%
\label{sec:frontend}\index{Front end}\index{User!interface}

\gls{ui} has been created with the idea of being as simple as possible. In this
way, any type of non-specialized user will be able to carry out a qualitative
evaluation of the model used. See \vref{fig:web} for a screenshot of the web
interface.

\begin{figure}[ht]
  \centering
  \includegraphics[width=.75\textwidth]{Images/Web.png}
  \caption[Screenshot of the created web]{Screenshot of the created web. In it
    you can see the navbar and the first part of the web. Figure created by the
    author.}\label{fig:web}
\end{figure}

In addition to proposing an interactive medium where \gls{rec} can be done with
arbitrary images and \gls{re}, on the web you can also find explanations about
this work, download this report and find all the source code developed. This
website will be a public and transparent online version containing all the work
of this thesis.

Different ways of interacting with this interface are possible. Among them, for
example, three options have been added to introduce images for the realization
of \gls{rec}. These are the following,
\begin{itemize}
  \item \textbf{Gallery}. Different images are shown in a gallery inserted on
  the web. These are taken from the \gls{coco} dataset.\footnote{It should be
    noted here that, when taken from the \gls{coco} dataset, most of the images
    that appear in this gallery \emph{no} have been used to train the neural
    model.}
  \item \textbf{Web address}. An image can also be added to the web from an
  external source using its web address (the URL).
  \item \textbf{Locally}. Finally, it is possible to upload an image from your
  own computer's local storage to the web.
\end{itemize}

In the case of adding \gls{re} there are two options in order to facilitate
interaction with the model. These are the following,
\begin{itemize}
  \item \textbf{Keyboard}. \gls{re} can be entered using the keyboard in the
  usual way.
  \item \textbf{Voice}. You can also enter \gls{re} more comfortably using your
  voice. To do this, it is only necessary to press the corresponding button on
  the main page so that the window corresponding to the voice input of commands
  opens (see \vref{fig:voice}). Here we will have to give permissions to the
  web to access the microphone and we will be able to record the \gls{re} that
  we want.
  \begin{figure}[ht]
    \centering
    \includegraphics[width=.75\textwidth]{Images/Voice.png}
    \caption[Web interface for voice input]{Web interface for voice input. Here
      you can speak directly into the computer's microphone as an alternative
      method of entering a \ gls {re}. This audio will be converted using a
      neural model to text. Figure created by the author.}\label{fig:voice}
  \end{figure}
\end{itemize}


\subsection{Responsive Design and Accessibility}%
\index{Responsive design}\index{Accesibility}

Responsive web design and accessibility are two different concepts, but they
are still related to each other in many ways. These two concepts fit within the
idea of \gls{ux}\index{User!experience} which is the way in which a user
interacts with a certain product or service. This includes the user's
perception of efficiency, ease of use and usefulness.

\gls{rd} is concerned with providing the user with the best possible viewing
experience regardless of the device being used. That is, the interface of a
website is capable of adapting to the dimensions of the screen being used: the
website will be displayed differently depending on whether it is being used on
a computer, tablet or mobile monitor. Accessibility is concerned with ensuring
that the content is easily usable, navigable by people with certain
disabilities (e.g., vision problems).

We can see how the web created adapts to different widths by comparing
\vref{fig:web} with \vref{fig:responsive}. Among other aspects, the gallery
adapts the number of columns according to the device and the navigation bar
expands or collapses also depending on the width of the screen.

\begin{figure}[ht]
  \centering
  \begin{subfigure}[t]{.5\textwidth}
    \centering
    \caption{Collapsed navigation bar.}
    \includegraphics[width=.6\textwidth]{Images/Responsive.png}
  \end{subfigure}\hfill
  \begin{subfigure}[t]{.5\textwidth}
    \centering
    \caption{Expanded navigation bar.}
    \includegraphics[width=.6\textwidth]{Images/Responsive2.png}
  \end{subfigure}
  \caption[Responsive web design.]{Responsive web design. The web is displayed
    in a typical mobile device width. The web is designed to be displayed
    correctly regardless of the width of the device used. Figure created by the
    author (both).}\label{fig:responsive}
\end{figure}

In addition to these two commented elements (navigation bar and gallery) other
different elements also adjust to the different screen widths. Among them the
footer, the width of the resulting segmented image, the size of the \gls{re}
and many more.

Another fundamental aspect when making a web design is that of
\emph{accessibility}\index{Accesibility}. In the words of
\myCite{berners-lee21:introd_web_acces}, \gls{w3c}\footnote{Is the main
  international standards organization for the World Wide Web} Director and
inventor of the World Wide Web,

\begin{quoteBox}
  The power of the Web is in its universality. Access by everyone regardless of
  disability is an essential aspect. \tcblower
  \quotecite{berners-lee21:introd_web_acces}
\end{quoteBox}

To guarantee the accessibility of this website, \gls{aria} has been used, which
is a specification of \gls{w3c} that specifies how to increase the
accessibility of web pages. This has been facilitated by the use of a style
library \gls{css} called \fhref{https://getbootstrap.com/}{Bootstrap}.


\subsection{Guided Usage Example}

To carry out the task of \gls{rec} on an image, it is only necessary to carry
out these three steps,
\begin{enumerate}
  \item \textbf{Choose image}. As we have already discussed at the beginning of
  \vref{sec:frontend}, three ways are available: select from the gallery, add
  the web address or choose it from the local storage of the computer.
  \item \textbf{Enter \gls*{re}}. Likewise, for the introduction of \gls{re}
  there are two methods: by using the keyboard and by using voice.
  \item \textbf{View results}. Finally, after clicking on the button
  \texttt{Submit}, we can see the result of the execution of the program.
\end{enumerate}

These methods have been tested and all of them work correctly, although with
different execution times depending on the method used. This execution time
will mainly depend on three factors, server usage, selected image quality and
the input method of \gls{re} (by voice it will take longer).

\begin{exampleBox}
  To have an approximation, using images from the gallery shown on the web,
  with a single user browsing (unsaturated server, which is usual) and entering
  the \gls{re} using the keyboard, the complete execution of the program is
  about 6 seconds.
\end{exampleBox}



\section{Back End}\label{sec:backend}\index{Back end}

The main functionality offered by this website is to be able to interact with
this work, i.e., to be able to execute the present model to perform
\gls{rec}. This entails the execution of code, which could be chosen to execute
it in two different places: on the user's computer (JavaScript should be used)
or on the web server (the back end).

Due to the high use of computational resources in the execution of the model,
it has been decided to carry it out completely in the back end.\footnote{This
  also facilitates the possibility of executing the code in Python, since if it
  would not be necessary to port all the code to JavaScript or use libraries
  with which to emulate Python within the client's browser.} For this, a
\gls{api} (created in PHP) has been created to facilitate communication between
front end and back end without having to reload the page. We have two main
routes that we will use to communicate the web interface with the
backend. These are the following,
\begin{itemize}
  \item \textbf{\gls*{rec}}. Internally called \code{api/comprehend.php}, which
  allows to perform the task of \gls{rec} by calling the appropriate Python
  files internally on the server (executing the segmentation model on user
  input, see \vref{sec:rec-model}). It takes into account the different ways in
  which the image and \gls{re} have been added.
  \item \textbf{\gls*{stt}}. Internally called \code{api/stt.php}, which allows
  to perform the task of converting between speech and text. Run the Silero
  model (see \vref{sec:speech}) to convert the audio recorded with the
  microphone by the user to text.
\end{itemize}

Here we will see the structure of the backend. An explanatory graph is found in
\vref{fig:server}.

\begin{figure}[p]
  \centering
  \resizebox{\textwidth}{!}{\input{Figures/Tikz/Server.tex}}
  \caption[Program architecture]{Program architecture. You can observe the
    transmission of data from the client (the user with his web browser), up to
    the generation of results through the \ gls {api} on the server. Figure
    created by the author.}\label{fig:server}
\end{figure}
